data;

set GENERATORS := G1 G2 G3 G4 G5 G6 G7 G8 G9 G10 G11 G12 G13 G14 G15 G16 G17 G18 G19 G20 G21 G22 G23 G24 G25 G26 G27 G28 G29 G30 G31 G32;
set GENPARAMS := Pmin Pmax MINCOST STCOST FUEL MUT MDT RU RD SUR SDR INI a b c; #MC	RU	RD	Pmax	Pmin Ton	Toff	SUR	SDR	K	J	INI	;
set ES_PARAMS := Pmax_ch Pmax_dis RU_S RD_S Emax Emin E0 eta_ch eta_dis b_dis c_dis b_ch c_ch;

set TIME := 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24;
set TIME_AF24H := 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27;

set LIN_SEGMENTS := S1 S2 S3;
set DIS_LIN_SEG := DS1 DS2;									#Lin Segments in Discharging Mode
set CH_LIN_SEG := CS1 CS2;									#Lin Segments in charging Mode


set HERM_COEF := H1 H2 H3 H4;								#Hermite coefficients 
set HERM_COEF_D4 := 1 2 3 4 5;					#Hermite coefficients of deg 4

set BERN_COEF_D2 := BE2_1 BE2_2 BE2_3;						#Bernstein coefficients of deg 2
set BERN_COEF_Dp2 := BEp2_1 BEp2_2;							#Bernstein coefficients of deg 2
set BERN_COEF_D3 := BE3_1 BE3_2 BE3_3 BE3_4;				#Bernstein coefficients of deg 3
set BERN_COEF_D4 := BE4_1 BE4_2 BE4_3 BE4_4 BE4_5;			#Bernstein coefficients of deg 4

set ENERGY_ST := 1;
set G_TYPE := Hydro Nuclear Coal350 Coal155 Coal76 Oil100 Oil197 Oil20 Oil12;

set r := 1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31	32	33	34	35	36	37	38	39	40	41	42	43	44	45	46	47	48	49	50	51	52	53	54	55	56	57	58	59	60	61	62	63	64	65	66	67	68	69	70	71	72	73	74	75	76	77	78	79	80	81	82	83	84	85	86	87	88	89	90	91	92	93	94	95	96	97	98	99	100	101	102	103	104	105	106	107	108	109	110	111	112	113	114	115	116	117	118	119	120	121	122	123	124	125	126	127	128	129	130	131	132	133	134	135	136	137	138	139	140	141	142	143	144	145	146	147	148	149	150	151	152	153	154	155	156	157	158	159	160	161	162	163	164	165	166	167	168	169	170	171	172	173	174	175	176	177	178	179	180	181	182	183	184	185	186	187	188	189	190	191	192	193	194	195	196	197	198	199	200	201	202	203	204	205	206	207	208	209	210	211	212	213	214	215	216	217	218	219	220	221	222	223	224	225	226	227	228	229	230	231	232	233	234	235	236	237	238	239	240	241	242	243	244	245	246	247	248	249	250	251	252	253	254	255	256	257	258	259	260	261	262	263	264	265	266	267	268	269	270	271	272	273	274	275	276	277	278	279	280	281	282	283	284	285	286	287	288	289	290	291	292	293	294	295	296	297	298	299	300	301	302	303	304	305	306	307	308	309	310	311	312	313	314;
set c := 1;

param N_H :
	H1				H2				H3				H4 :=
1	2069.163094		-124.2681363	1974.147857		-68.27900918
2	1974.147857		-68.27900918	1927.251189		-28.81039089
3	1927.251189		-28.81039089	1940.008403		7.626638495
4	1940.008403		7.626638495		1994.311148		73.88119056
5	1994.311148		73.88119056		2069.620489		179.0574761
6	2069.620489		179.0574761		2333.734662		242.930937
7	2333.734662		242.930937		2563.94044		131.8271125
8	2563.94044		131.8271125		2618.282328		-34.44225903
9	2618.282328		-34.44225903	2474.369844		-65.60083668
10	2474.369844		-65.60083668	2457.50363		-70.32541532
11	2457.50363		-70.32541532	2374.054189		-80.5038641
12	2374.054189		-80.5038641		2321.857187		-48.75718092
13	2321.857187		-48.75718092	2299.525729		1.491261822
14	2299.525729		1.491261822		2301.493954		16.78469015
15	2301.493954		16.78469015		2263.818554		19.27349129
16	2263.818554		19.27349129		2321.288772		98.27601049
17	2321.288772		98.27601049		2469.620344		221.2299871
18	2469.620344		221.2299871		2851.336405		141.7764794
19	2851.336405		141.7764794		2756.088282		-35.68818405
20	2756.088282		-35.68818405	2734.340651		-80.94679254
21	2734.340651		-80.94679254	2607.441545		-144.3062343
22	2607.441545		-144.3062343	2446.416319		-200.7374779
23	2446.416319		-200.7374779	2197.591775		-182.3569609
24	2197.591775		-182.3569609	2058.935292		-124.167623

;

param GenData(tr) :
          Pmin      Pmax      MINCOST      STCOST      FUEL      MUT      MDT     RU     RD     SUR     SDR   INI          a        b       c 		:=
G1        16        20        162.24        5          3         1        1       3      3      3       3     0           -68.64  14.43     0
G2        16        20        162.24        5          3         1        1       3      3      3       3     0           -68.64  14.43     0
G3        15.2      76        145.16       596         1.2       8        4       2      2      2       2     0           13.188  8.199   0.0353
G4        15.2      76        145.16       596         1.2       8        4       2      2      2       2     0           13.188  8.199   0.0353
G5        16        20        162.24        5          3         1        1       3      3      3       3     0           -68.64  14.43     0
G6        16        20        162.24        5          3         1        1       3      3      3       3     0           -68.64  14.43     0
G7        15.2      76        145.16       596         1.2       8        4       2      2      2       2     0           13.188  8.199   0.0353
G8        15.2      76        145.16       596         1.2       8        4       2      2      2       2     0           13.188  8.199   0.0353
G9        25        100       202.25       566         2.3       8        8       7      7      7       7     0           -2.544  7.8986  0.0113
G10       25        100       202.25       566         2.3       8        8       7      7      7       7     0           -2.544  7.8986  0.0113
G11       25        100       202.25       566         2.3       8        8       7      7      7       7     0           -2.544  7.8986  0.0113
G12       69        197       576.15       775         2.3       12       10      3      3      3       3     0           5.8517  7.9425  0.0047
G13       69        197       576.15       775         2.3       12       10      3      3      3       3     0           5.8517  7.9425  0.0047
G14       69        197       576.15       775         2.3       12       10      3      3      3       3     0           5.8517  7.9425  0.0047
G15       2.4       12        24.43        68          2.3       4        2       1      1      1       1     0           2.9404  8.4681  0.2131
G16       2.4       12        24.43        68          2.3       4        2       1      1      1       1     0           2.9404  8.4681  0.2131
G17       2.4       12        24.43        68          2.3       4        2       1      1      1       1     0           2.9404  8.4681  0.2131
G18       2.4       12        24.43        68          2.3       4        2       1      1      1       1     0           2.9404  8.4681  0.2131
G19       2.4       12        24.43        68          2.3       4        2       1      1      1       1     0           2.9404  8.4681  0.2131
G20       54.25     155       448.37       953         1.2       8        8       3      3      3       3     0           18.381  7.589   0.0063
G21       54.25     155       448.37       953         1.2       8        8       3      3      3       3     0           18.381  7.589   0.0063
G22       100       400       885          0           0.6       1        1       20     20     20      20    0           11.914  8.6168  0.0011
G23       100       400       885          0           0.6       1        1       20     20     20      20    0           11.914  8.6168  0.0011
G24       50        50        0            0           0         0        0       0      0      0       0     0             0       0       0
G25       50        50        0            0           0         0        0       0      0      0       0     0             0       0       0
G26       50        50        0            0           0         0        0       0      0      0       0     0             0       0       0
G27       50        50        0            0           0         0        0       0      0      0       0     0             0       0       0
G28       50        50        0            0           0         0        0       0      0      0       0     0             0       0       0
G29       50        50        0            0           0         0        0       0      0      0       0     0             0       0       0
G30       54.25     155       448.37       953         1.2       8        8       3      3      3       3     0           18.381  7.589   0.0063
G31       54.25     155       448.37       953         1.2       8        8       3      3      3       3     0           18.381  7.589   0.0063
G32       140       350       1176         4468        1.2       24       48      4      4      4       4     0           41.144  7.6469  0.0033
;
param ES_Data:
		Pmax_ch    Pmax_dis    RU_S   RD_S   Emax   Emin   E0   eta_ch  eta_dis      b_dis    c_dis    b_ch    c_ch :=
1     250        250         25     25     1200   0      0    0.9     0.9          21.25    0.002    10.75   -0.002
;

#Conversion matrix for the first derivative of bernstein polynomials (obtaining BE2 from BE3)
param O:
			BE2_1	BE2_2	BE2_3 :=
	BE3_1	-3		0		0	
	BE3_2	3		-3		0
	BE3_3	0		3		-3
	BE3_4	0		0		3		
;

param OO:
			BEp2_1	BEp2_2 :=
	BE2_1	-2		0			
	BE2_2	2		-2	
	BE2_3	0		2				
;

param O_hat:   # Conversion matrix for the integral of the Bernstein polynomials
        1 		2 		3 		4 		5 :=
BE3_1   0       0.25    0.25    0.25    0.25
BE3_2   0       0       0.25    0.25    0.25
BE3_3   0       0       0       0.25    0.25
BE3_4   0       0       0       0       0.25
;
param W:	
			BE3_1	BE3_2	BE3_3	BE3_4 :=
	H1		1		1		0		0
	H2		0		0		0		0
	H3		0		0		1		1
	H4		0		0		0		0
;

param Slope (tr): #gamma
          S1         S2        S3	:=
G1        14.43       0        0
G2        14.46       0        0
G3        9.97      11.58    13.31
G4        10        11.61    13.34
G5        14.49       0        0
G6        14.4        0        0
G7        10.03     11.64    13.37
G8        9.94      11.55    13.28
G9        8.71      9.42     9.88
G10        8.74     9.45     9.91
G11        8.68     9.39     9.85
G12        8.83     9.22     9.62
G13        8.86     9.25     9.65
G14        8.8      9.19     9.59
G15        10.33    11.67    13.22
G16        10.36    11.7     13.25
G17        10.39    11.73    13.28
G18        10.3     11.64    13.19
G19        10.27    11.61    13.16
G20        8.54     8.9      9.38
G21        8.57     8.93     9.41
G22        8.96     9.21     9.44
G23        8.93     9.18     9.41
G24        0        0        0
G25        0        0        0
G26        0        0        0
G27        0        0        0
G28        0        0        0
G29        0        0        0
G30        8.6     8.96     9.44
G31        8.51    8.87     9.35
G32        8.89    9.24     9.77
;

param Len(tr): #lm
          S1        S2         S3 :=
G1       4.0        0.0        0.0
G2       4.0        0.0        0.0
G3      22.8       22.8       15.2
G4      22.8       22.8       15.2
G5       4.0        0.0        0.0
G6       4.0        0.0        0.0
G7      22.8       22.8       15.2
G8      22.8       22.8       15.2
G9      25.0       30.0       20.0
G10     25.0       30.0       20.0
G11     25.0       30.0       20.0
G12     49.2       39.4       39.4
G13     49.2       39.4       39.4
G14     49.2       39.4       39.4
G15      3.6        3.6        2.4
G16      3.6        3.6        2.4
G17      3.6        3.6        2.4
G18      3.6        3.6        2.4
G19      3.6        3.6        2.4
G20     38.75      31.0       31.0
G21     38.75      31.0       31.0
G22     100.0      120.0      80.0
G23     100.0      120.0      80.0
G24     50.0        0.0        0.0
G25     50.0        0.0        0.0
G26     50.0        0.0        0.0
G27     50.0        0.0        0.0
G28     50.0        0.0        0.0
G29     50.0        0.0        0.0
G30     38.75      31.0       31.0
G31     38.75      31.0       31.0
G32     87.5       52.5       70.0    
;

param  LG:#  maximum discharging in each segment for ES
        DS1   DS2:=
1     125   125
;

param  LD: #  maximum charging in each segment for ES
        CS1   CS2:=
1     125   125
;

param  CG:#  generation price of ES
		DS1     DS2:=
1  	18.5    19
;

param  CD:#  generation price of ES
		CS1     CS2:=
1  	10.5    10
;

param RSC := 1; 

param Load:	
		c1:=
r1		23738
r2		23542
r3		23372
r4		23213
r5		23050
r6		22895
r7		22739
r8		22596
r9		22472
r10		22353
r11		22226
r12		22109
r13		22029
r14		21966
r15		21903
r16		21810
r17		21715
r18		21622
r19		21526
r20		21436
r21		21357
r22		21282
r23		21209
r24		21148
r25		21092
r26		21058
r27		21031
r28		20996
r29		20937
r30		20881
r31		20823
r32		20764
r33		20713
r34		20669
r35		20631
r36		20600
r37		20570
r38		20541
r39		20514
r40		20488
r41		20464
r42		20444
r43		20424
r44		20406
r45		20393
r46		20405
r47		20431
r48		20464
r49		20477
r50		20493
r51		20509
r52		20521
r53		20531
r54		20544
r55		20557
r56		20573
r57		20582
r58		20584
r59		20603
r60		20661
r61		20731
r62		20797
r63		20865
r64		20934
r65		21004
r66		21078
r67		21150
r68		21242
r69		21356
r70		21472
r71		21613
r72		21801
r73		22013
r74		22202
r75		22389
r76		22577
r77		22757
r78		22932
r79		23104
r80		23281
r81		23470
r82		23640
r83		23856
r84		24169
r85		24540
r86		24873
r87		25168
r88		25460
r89		25715
r90		25930
r91		26138
r92		26342
r93		26483
r94		26593
r95		26740
r96		26915
r97		27122
r98		27273
r99		27351
r100	27401
r101	27462
r102	27469
r103	27452
r104	27488
r105	27498
r106	27457
r107	27383
r108	27359
r109	27329
r110	27294
r111	27257
r112	27204
r113	27132
r114	27037
r115	26963
r116	26865
r117	26757
r118	26676
r119	26598
r120	26498
r121	26403
r122	26391
r123	26410
r124	26346
r125	26249
r126	26149
r127	26034
r128	26055
r129	26089
r130	26074
r131	26013
r132	25972
r133	25929
r134	25868
r135	25705
r136	25544
r137	25446
r138	25354
r139	25260
r140	25158
r141	25112
r142	25070
r143	25025
r144	24974
r145	24919
r146	24867
r147	24815
r148	24763
r149	24703
r150	24625
r151	24535
r152	24457
r153	24412
r154	24366
r155	24334
r156	24294
r157	24239
r158	24174
r159	24110
r160	24069
r161	24028
r162	23990
r163	23950
r164	23954
r165	23977
r166	23980
r167	23947
r168	23916
r169	23901
r170	23888
r171	23969
r172	24088
r173	24183
r174	24190
r175	24196
r176	24207
r177	24223
r178	24243
r179	24264
r180	24287
r181	24270
r182	24216
r183	24190
r184	24219
r185	24243
r186	24262
r187	24247
r188	24240
r189	24227
r190	24211
r191	24208
r192	24231
r193	24255
r194	24291
r195	24317
r196	24356
r197	24398
r198	24431
r199	24450
r200	24465
r201	24499
r202	24573
r203	24612
r204	24636
r205	24683
r206	24749
r207	24848
r208	24959
r209	25057
r210	25144
r211	25260
r212	25380
r213	25530
r214	25696
r215	25883
r216	26101
r217	26345
r218	26569
r219	26744
r220	26958
r221	27206
r222	27453
r223	27702
r224	27961
r225	28245
r226	28529
r227	28847
r228	29160
r229	29403
r230	29512
r231	29679
r232	29875
r233	30053
r234	30080
r235	29972
r236	29821
r237	29694
r238	29587
r239	29441
r240	29309
r241	29269
r242	29232
r243	29194
r244	29129
r245	29059
r246	29000
r247	28992
r248	28950
r249	28888
r250	28832
r251	28782
r252	28718
r253	28645
r254	28577
r255	28507
r256	28439
r257	28368
r258	28290
r259	28213
r260	28132
r261	28042
r262	27956
r263	27856
r264	27723
r265	27573
r266	27432
r267	27293
r268	27154
r269	26998
r270	26852
r271	26716
r272	26576
r273	26428
r274	26287
r275	26127
r276	25881
r277	25593
r278	25338
r279	25145
r280	24970
r281	24795
r282	24622
r283	24470
r284	24331
r285	24191
r286	24031
r287	23835
r288	23610
r289	23373
r290	23180
r291	23045
r292	22903
r293	22745
r294	22593
r295	22442
r296	22296
r297	22165
r298	22040
r299	21915
r300	21812
r301	21714
r302	21616
r303	21515
r304	21418
r305	21320
r306	21225
r307	21128
r308	21037
r309	20962
r310	20922
r311	20864
r312	20806
r313	20754
;

for {i in GENERATORS} 
{
	for {p in GENPARAMS}
	{
		let Copy_GenData[p,i] := GenData[p,i];
	}
}

for {i in ENERGY_ST} 
{
	for {p in ES_PARAMS}
	{
		let Copy_ES_Data[i,p] := ES_Data[i,p];
	}
}

for {i in GENERATORS} {
	let RTP[i] := (1/3) * Slope ['S3', i]; 
	let GenData['RU',i] := 60 * GenData['RU',i] / RSC;
	let GenData['RD',i] := 60 * GenData['RD',i] / RSC;
	
	if (60 * GenData['SUR',i]) > (GenData['Pmax',i]) then 
	{
		let GenData['SUR',i] := GenData['Pmax',i];
	}
	else 
	{
		let GenData['SUR',i] := 60 * GenData['SUR',i] ;
	}	
	if (60 * GenData['SDR',i]) > (GenData['Pmax',i]) then 
	{
		let GenData['SDR',i] := GenData['Pmax',i];
	}
	else
	{
		let GenData['SDR',i] := 60 * GenData['SDR',i] ;
	}
	for {n in LIN_SEGMENTS}
	{
		let CostRate[i,n] := Slope [n,i] * GenData['FUEL',i];
	}
}

let RTP['G1'] := Slope ['S1', 'G1'] * (1/3);
let RTP['G2'] := Slope ['S1', 'G2'] * (1/3);
let RTP['G5'] := Slope ['S1', 'G5'] * (1/3);
let RTP['G6'] := Slope ['S1', 'G6'] * (1/3);


for {j in ENERGY_ST}
{
	let ES_Data[j, 'RU_S'] := 60 * ES_Data[j, 'RU_S'] / RSC;
	let ES_Data[j, 'RD_S'] := 60 * ES_Data[j, 'RD_S'] / RSC;
}

let W['H2', 'BE3_2'] := 1/3;
let W['H4', 'BE3_3'] := -1/3;

for {t in TIME, b in BERN_COEF_D3} {
	let L_B [b,t] := sum {h in HERM_COEF} (W[h,b] * N_H[t,h]);
}

for {t in TIME, bp in BERN_COEF_D2} {
	let Lp_B [bp,t] := sum {b in BERN_COEF_D3} (O[b, bp] * L_B[b,t]);
}

